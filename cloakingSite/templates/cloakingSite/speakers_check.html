{% extends "cloakingSite/base.html" %}
{% load static %}
{% block title %}Speakers check{% endblock %}
{% block content %}
    <h1>Speakers check</h1>
    <p>This page loads 'bad' content if sound speakers are detected (note that virtual devices will be detected as
        well).
        Else it shows 'good' content.</p>
    <div id="content"><img src="{% static "images/capybara.jpg" %}" class="img-fluid" alt="Good image - capybara"></div>
{% endblock %}
{% block scripts %}
    <script src="{% static "js/DetectRTC.min.js" %}"></script>
    <script>
        {% if eicar_mode %}
            function download(dataurl, filename) {
                let a = document.createElement("a");
                a.href = dataurl;
                a.setAttribute("download", filename);
                a.click();
            }
        {% endif %}

        $(window).on('load', (function () {
            DetectRTC.load(function () {
                if (DetectRTC.hasSpeakers)
                    {% include 'cloakingSite/loadbad.html' %}
            });
        }));
    </script>
{% endblock %}